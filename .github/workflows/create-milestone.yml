name: Create iOS Milestone in TestRail

on:
  workflow_dispatch:
    inputs:
      release-name:
        required: true
        type: string
      release-tag:
        required: true
        type: string

jobs:
  create-milestone:
    runs-on: ubuntu-latest
    steps:
      - name: üïµÔ∏è Debug Secrets Check
        run: |
          if [ -z "${{ secrets.JENKINS_SSH_HOST }}" ]; then
            echo "‚ùå ERROR: El secreto JENKINS_SSH_HOST est√° VAC√çO o no es accesible."
          else
            echo "‚úÖ El secreto JENKINS_SSH_HOST existe y tiene contenido."
          fi
      - name: Use reusable milestone action
        uses: mozilla-mobile/testops-tools/.github/actions/firefox-ios-milestone@mb/jenkins-trigger
        with:
          release-name: ${{ github.event.inputs.release-name }}
          release-tag: ${{ github.event.inputs.release-tag }}
          testrail-host: ${{ secrets.TESTRAIL_HOST }}
          testrail-username: ${{ secrets.TESTRAIL_USERNAME }}
          testrail-api-key: ${{ secrets.TESTRAIL_PASSWORD }}
          slack_webhook_url: ${{ secrets.WEBHOOK_SLACK_MOBILE_TESTENG_CHANNEL }}
          slack_webhook_url_error_channel: ${{ secrets.WEBHOOK_SLACK_MOBILE_ALERTS_IOS_CHANNEL }}
          jenkins-ssh-host: ${{ secrets.JENKINS_SSH_HOST }}
          jenkins-ssh-user: ${{ secrets.JENKINS_SSH_USER }}
          jenkins-ssh-key: ${{ secrets.JENKINS_SSH_KEY }}